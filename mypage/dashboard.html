<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>나의 여백 | 여백의 시간</title>

<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@300;400;600&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;}

body{
  font-family:'Noto Serif KR',serif;
  background:#f6f2ea;
  color:#3e3a36;
  line-height:1.9;
}

nav{
  text-align:center;
  padding:25px 0;
  font-size:0.9rem;
}
nav a{
  margin:0 18px;
  text-decoration:none;
  color:#555;
}
nav a:hover{opacity:0.5;}

.container{
  max-width:1000px;
  margin:120px auto;
  padding:0 20px;
}

h1{font-weight:400;margin-bottom:20px;}
.subtitle{color:#7a746e;margin-bottom:40px;}

.card{
  background:#fffdf8;
  padding:40px;
  margin-bottom:40px;
  box-shadow:0 10px 30px rgba(0,0,0,0.05);
}

.progress-bar{
  height:8px;
  background:#e5dfd6;
  margin-top:10px;
}
.progress{
  height:8px;
  background:#3e3a36;
  width:70%;
}

canvas{
  margin-top:20px;
}

.calendar{
  display:grid;
  grid-template-columns:repeat(7,1fr);
  gap:8px;
  margin-top:20px;
}
.day{
  background:#eee8dd;
  padding:12px;
  text-align:center;
  font-size:0.8rem;
}
.active{
  background:#3e3a36;
  color:white;
}

.premium{
  border:1px solid #ddd;
  padding:25px;
  text-align:center;
  background:#faf7f0;
}

button{
  margin-top:15px;
  padding:10px 18px;
  border:none;
  background:#3e3a36;
  color:white;
  cursor:pointer;
}

.logout{
  margin-top:20px;
  cursor:pointer;
  color:#888;
}

footer{
  text-align:center;
  padding:80px;
  font-size:0.8rem;
  color:#aaa;
}
</style>
</head>

<body>

<script>
if(!localStorage.getItem("currentUser")){
  window.location.href="auth/login.html";
}
</script>

<nav>
<a href="../index.html">Home</a>
<a href="../community.html">Community</a>
<a href="dashboard.html">My</a>
</nav>

<div class="container">

<h1 id="welcome"></h1>
<div class="subtitle">당신의 기록이 쌓이는 조용한 공간</div>

<!-- AI 질문 -->
<div class="card">
<h2>오늘의 AI 질문</h2>
<p id="aiQuestion">질문을 불러오는 중...</p>
<button onclick="generateAI()">새 질문 받기</button>
</div>

<!-- 최근 기록 -->
<div class="card">
<h2>나의 최근 기록</h2>
<div id="myEntries"></div>
</div>

<!-- 통계 -->
<div class="card">
<h2>기록 통계</h2>
<canvas id="statsChart" width="400" height="150"></canvas>
</div>

<!-- 감정 달력 -->
<div class="card">
<h2>기록 달력</h2>
<div class="calendar" id="calendar"></div>
</div>

<!-- 수강 진행 -->
<div class="card">
<h2>수강 진행률</h2>
<div class="progress-bar">
<div class="progress"></div>
</div>
<p style="margin-top:10px;">현재 3주차 진행 중</p>
</div>

<!-- 프리미엄 -->
<div class="card premium">
<h2>프리미엄 멤버십</h2>
<p>AI 무제한 질문 · 기록 분석 리포트 · 클라우드 저장</p>
<button onclick="upgrade()">프리미엄 시작하기</button>
</div>

<div class="logout" onclick="logout()">로그아웃</div>

</div>

<footer>© 2026 여백의 시간</footer>

<script>

/* 사용자 */
const currentUser = localStorage.getItem("currentUser");
const users = JSON.parse(localStorage.getItem("users"))||[];
const user = users.find(u=>u.email===currentUser);

document.getElementById("welcome").innerText =
`${user ? user.name : "사용자"}님의 여백`;

/* 기록 */
const entries = JSON.parse(localStorage.getItem("communityEntries"))||[];
const myEntries = entries.filter(e=>e.user===currentUser);

const container = document.getElementById("myEntries");
if(myEntries.length===0){
  container.innerHTML="아직 기록이 없습니다.";
}else{
  myEntries.slice(-3).forEach(e=>{
    const p=document.createElement("p");
    p.innerText=e.text;
    container.appendChild(p);
  });
}

/* 통계 차트 */
const ctx=document.getElementById("statsChart").getContext("2d");
ctx.fillStyle="#3e3a36";
ctx.fillRect(10,20,myEntries.length*20,20);
ctx.font="12px serif";
ctx.fillText("총 기록 수: "+myEntries.length,10,15);

/* 달력 */
const calendar=document.getElementById("calendar");
for(let i=1;i<=30;i++){
  const div=document.createElement("div");
  div.classList.add("day");
  div.innerText=i;
  if(myEntries.length>i%5){
    div.classList.add("active");
  }
  calendar.appendChild(div);
}

/* AI 질문 (Mock) */
function generateAI(){
  const questions=[
    "오늘 나를 가장 웃게 만든 순간은?",
    "지금 나에게 필요한 한 문장은?",
    "내 마음이 머무는 곳은 어디인가요?",
    "오늘 하루를 한 글자로 표현한다면?"
  ];
  const q=questions[Math.floor(Math.random()*questions.length)];
  document.getElementById("aiQuestion").innerText=q;
}

/* 프리미엄 */
function upgrade(){
  alert("프리미엄 기능은 곧 오픈됩니다.");
}

/* 로그아웃 */
function logout(){
  localStorage.removeItem("currentUser");
  window.location.href="index.html";
}

generateAI();

</script>

</body>
</html>
