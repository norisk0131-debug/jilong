<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Community | ì—¬ë°±ì˜ ì‹œê°„</title>

<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@300;400;600&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;}

body{
  font-family:'Noto Serif KR',serif;
  background:#f6f2ea;
  color:#3e3a36;
  line-height:2;
}

nav{text-align:center;padding:25px 0;}
nav a{margin:0 18px;text-decoration:none;color:#555;}

section{
  max-width:900px;
  margin:120px auto;
  padding:0 20px;
  text-align:center;
}

.card{
  background:#fffdf8;
  padding:40px;
  margin-bottom:30px;
  box-shadow:0 10px 30px rgba(0,0,0,0.05);
  text-align:left;
}

textarea{
  width:100%;
  height:120px;
  padding:15px;
  border:1px solid #ccc;
  font-family:'Noto Serif KR',serif;
}

.button{
  display:inline-block;
  margin-top:15px;
  padding:10px 25px;
  border:1px solid #3e3a36;
  background:none;
  cursor:pointer;
}
.button:hover{background:#3e3a36;color:#fff;}

.leaf-btn{
  margin-top:10px;
  font-size:0.9rem;
  cursor:pointer;
  color:#7a746e;
}

.delete-btn{
  font-size:0.8rem;
  color:#aaa;
  cursor:pointer;
  margin-top:8px;
}

footer{text-align:center;padding:80px;font-size:0.8rem;color:#aaa;}
</style>
</head>

<body>
<script>
if(!localStorage.getItem("currentUser")){
  window.location.href="auth/login.html";
}
</script>

<nav>
<a href="index.html">Home</a>
<a href="about.html">About</a>
<a href="classes.html">Classes</a>
<a href="gallery.html">Gallery</a>
<a href="studio.html">Studio</a>
<a href="community.html">Community</a>
<a href="mypage/dashboard.html">My</a>
</nav>

<section>
<h1>ì¡°ìš©íˆ ë¨¸ë¬´ëŠ” ê¸°ë¡ì˜ ì •ì›</h1>
<p>ë¹„êµí•˜ì§€ ì•ŠëŠ” ê³µê°„ì…ë‹ˆë‹¤.</p>
</section>

<section>
<h2>ì˜¤ëŠ˜ì˜ ì§ˆë¬¸</h2>
<div class="card" id="todayQuestion"></div>
</section>

<section>
<h2>ì˜¤ëŠ˜ì˜ ê¸°ë¡</h2>
<div id="entryList"></div>
</section>

<section>
<h2>ê¸°ë¡ ë‚¨ê¸°ê¸° (í•˜ë£¨ 1íšŒ)</h2>
<div class="card">
<textarea id="newEntry" placeholder="ì§€ê¸ˆì˜ ë§ˆìŒì„ ì ì–´ë³´ì„¸ìš”..."></textarea>
<button class="button" onclick="submitEntry()">ê¸°ë¡ ë‚¨ê¸°ê¸°</button>
<div id="msg" style="margin-top:10px;font-size:0.9rem;color:#7a746e;"></div>
</div>
</section>

<footer>
Â© 2026 ì—¬ë°±ì˜ ì‹œê°„. All Rights Reserved.
</footer>

<script>

/* ì˜¤ëŠ˜ì˜ ì§ˆë¬¸ (AI í‰ë‚´ ëœë¤ ìƒì„±) */
const questions=[
"ë‚˜ëŠ” ë¬´ì—‡ì„ ë¶™ì¡ê³  ìˆì—ˆì„ê¹Œ?",
"ì˜¤ëŠ˜ ë‚˜ë¥¼ ê°€ì¥ ì§€ì¹˜ê²Œ í•œ ìƒê°ì€?",
"ì§€ê¸ˆ ë‚˜ì—ê²Œ í•„ìš”í•œ í•œ ë¬¸ì¥ì€?",
"ë‚˜ëŠ” ë¬´ì—‡ì„ ë†“ì•„ë„ ê´œì°®ì„ê¹Œ?",
"ì˜¤ëŠ˜ ë‚˜ë¥¼ ìœ„ë¡œí•  í•œ ë§ˆë””ëŠ”?"
];

function generateQuestion(){
  const random=questions[Math.floor(Math.random()*questions.length)];
  document.getElementById("todayQuestion").innerText=random;
}

/* ê¸°ë¡ ë¡œë“œ */
function loadEntries(){
  const entries=JSON.parse(localStorage.getItem("communityEntries"))||[];
  entries.forEach(e=>renderEntry(e));
}

/* ê¸°ë¡ í™”ë©´ ì¶œë ¥ */
function renderEntry(entry){
  const entryList=document.getElementById("entryList");

  const card=document.createElement("div");
  card.className="card";

  card.innerHTML=`
    <p>${entry.text.replace(/\n/g,"<br>")}</p>
    <div class="leaf-btn" onclick="addLeaf('${entry.id}')">
      ğŸŒ¿ ë¨¸ë¬¼ë €ì–´ìš” <span>${entry.likes}</span>
    </div>
    ${entry.own?'<div class="delete-btn" onclick="deleteEntry(\''+entry.id+'\')">ì‚­ì œ</div>':''}
  `;

  entryList.prepend(card);
}

/* ì €ì¥ */
function saveEntries(entries){
  localStorage.setItem("communityEntries",JSON.stringify(entries));
}

/* ì‘ì„± ì œí•œ */
function canWriteToday(){
  const today=new Date().toDateString();
  const last=localStorage.getItem("lastWriteDate");
  return last!==today;
}

/* ê¸°ë¡ ì œì¶œ */
function submitEntry(){
  const text=document.getElementById("newEntry").value.trim();
  if(text==="") return;

  if(!canWriteToday()){
    document.getElementById("msg").innerText="ì˜¤ëŠ˜ì€ ì´ë¯¸ ê¸°ë¡ì„ ë‚¨ê¸°ì…¨ìŠµë‹ˆë‹¤ ğŸŒ¿";
    return;
  }

  const entry={
    id:Date.now().toString(),
    text:text,
    likes:0,
    own:true
  };

  const entries=JSON.parse(localStorage.getItem("communityEntries"))||[];
  entries.unshift(entry);
  saveEntries(entries);

  localStorage.setItem("lastWriteDate",new Date().toDateString());

  renderEntry(entry);

  document.getElementById("newEntry").value="";
  document.getElementById("msg").innerText="ê¸°ë¡ì´ ë‚¨ê²¨ì¡ŒìŠµë‹ˆë‹¤.";
}

/* ê³µê° */
function addLeaf(id){
  let entries=JSON.parse(localStorage.getItem("communityEntries"))||[];
  entries=entries.map(e=>{
    if(e.id===id) e.likes++;
    return e;
  });
  saveEntries(entries);
  document.getElementById("entryList").innerHTML="";
  loadEntries();
}

/* ì‚­ì œ */
function deleteEntry(id){
  let entries=JSON.parse(localStorage.getItem("communityEntries"))||[];
  entries=entries.filter(e=>e.id!==id);
  saveEntries(entries);
  document.getElementById("entryList").innerHTML="";
  loadEntries();
}

/* ì´ˆê¸°í™” */
window.onload=function(){
  generateQuestion();
  loadEntries();
}

</script>

</body>
</html>
